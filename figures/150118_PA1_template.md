Reproducible research course project 1(submit on 150118)
========================================================

##1, Loading and preprocessing the data
First, we load the data(activity.csv) into act.
Next, we remove the row which contain NA.

```r
# 1-1,load the file
setwd("C:/Users/namazu/Desktop/150112_reproducibleResearch/repdata-data-activity")

act <- read.csv("activity.csv")

# 1-2 preprocessing the data by removing data which contain NA.
act_noNA <- act
act_noNA <- act[complete.cases(act), ]
levelList_noNA <- levels(act_noNA$date)
```


##2, What is mean total number of steps taken per day?
#2-1. Make a histogram of the total number of steps taken each day

```r
steps_eachday_noNA_sum <- vector()
for (j in 1:length(levelList_noNA)) {
    part <- subset(act_noNA, act_noNA$date == levelList_noNA[j])
    partSteps <- part$steps
    partSteps_df <- as.data.frame(partSteps)
    steps_eachday_noNA_sum[j] <- apply(partSteps_df, 2, sum)
}


barplot(steps_eachday_noNA_sum, names.arg = levelList_noNA, xlab = "date", ylab = "sum of steps in each day", 
    main = "sum of steps in each day")
```

![plot of chunk unnamed-chunk-2](figure/unnamed-chunk-2.png) 


#2-2. Calculate and report the mean and median total number of steps taken per day

```r

steps_eachday_noNA_mean <- vector()
steps_eachday_noNA_median <- vector()
for (j in 1:length(levelList_noNA)) {
    part <- subset(act_noNA, act_noNA$date == levelList_noNA[j])
    partSteps <- part$steps
    partSteps_df <- as.data.frame(partSteps)
    steps_eachday_noNA_mean[j] <- apply(partSteps_df, 2, mean)
    steps_eachday_noNA_median[j] <- apply(partSteps_df, 2, median)
}


# integrate the results into one dataframe
mean_median_df <- cbind(steps_eachday_noNA_mean, steps_eachday_noNA_median)
colnames(mean_median_df) <- c("mean of steps in each day", "median of steps in each day")

mean_median_df
```

```
##       mean of steps in each day median of steps in each day
##  [1,]                       NaN                          NA
##  [2,]                    0.4375                           0
##  [3,]                   39.4167                           0
##  [4,]                   42.0694                           0
##  [5,]                   46.1597                           0
##  [6,]                   53.5417                           0
##  [7,]                   38.2465                           0
##  [8,]                       NaN                          NA
##  [9,]                   44.4826                           0
## [10,]                   34.3750                           0
## [11,]                   35.7778                           0
## [12,]                   60.3542                           0
## [13,]                   43.1458                           0
## [14,]                   52.4236                           0
## [15,]                   35.2049                           0
## [16,]                   52.3750                           0
## [17,]                   46.7083                           0
## [18,]                   34.9167                           0
## [19,]                   41.0729                           0
## [20,]                   36.0938                           0
## [21,]                   30.6285                           0
## [22,]                   46.7361                           0
## [23,]                   30.9653                           0
## [24,]                   29.0104                           0
## [25,]                    8.6528                           0
## [26,]                   23.5347                           0
## [27,]                   35.1354                           0
## [28,]                   39.7847                           0
## [29,]                   17.4236                           0
## [30,]                   34.0938                           0
## [31,]                   53.5208                           0
## [32,]                       NaN                          NA
## [33,]                   36.8056                           0
## [34,]                   36.7049                           0
## [35,]                       NaN                          NA
## [36,]                   36.2465                           0
## [37,]                   28.9375                           0
## [38,]                   44.7326                           0
## [39,]                   11.1771                           0
## [40,]                       NaN                          NA
## [41,]                       NaN                          NA
## [42,]                   43.7778                           0
## [43,]                   37.3785                           0
## [44,]                   25.4722                           0
## [45,]                       NaN                          NA
## [46,]                    0.1424                           0
## [47,]                   18.8924                           0
## [48,]                   49.7882                           0
## [49,]                   52.4653                           0
## [50,]                   30.6979                           0
## [51,]                   15.5278                           0
## [52,]                   44.3993                           0
## [53,]                   70.9271                           0
## [54,]                   73.5903                           0
## [55,]                   50.2708                           0
## [56,]                   41.0903                           0
## [57,]                   38.7569                           0
## [58,]                   47.3819                           0
## [59,]                   35.3576                           0
## [60,]                   24.4688                           0
## [61,]                       NaN                          NA
```



##3 What is the average daily activity pattern?
#3-1. Make a time series plot (i.e. type = "l" ) of the 5minute interval (xaxis) and the average number of steps taken, averaged across all days (yaxis)


```r
# make interval data
intervals <- vector()
for (k in 0:471) {
    intervals[k + 1] <- 5 * k
}

# calculate mean of steps in each interval value.
steps_eachInterval_mean <- vector()
for (k in 0:471) {
    partInt <- subset(act_noNA, act_noNA$interval == k * 5)
    partIntSteps <- as.data.frame(partInt$steps)
    partIntSteps <- as.data.frame(partIntSteps[complete.cases(partIntSteps), 
        ])
    partIntSteps
    steps_eachInterval_mean[k + 1] <- apply(partIntSteps, 2, mean)
}

# making the dataframe to report the mean of steps in each interval
steps_eachInterval_mean <- cbind(intervals, steps_eachInterval_mean)
colnames(steps_eachInterval_mean) <- c("intervals", "mean of steps in each interval")
steps_eachInterval_mean
```

```
##        intervals mean of steps in each interval
##   [1,]         0                        1.71698
##   [2,]         5                        0.33962
##   [3,]        10                        0.13208
##   [4,]        15                        0.15094
##   [5,]        20                        0.07547
##   [6,]        25                        2.09434
##   [7,]        30                        0.52830
##   [8,]        35                        0.86792
##   [9,]        40                        0.00000
##  [10,]        45                        1.47170
##  [11,]        50                        0.30189
##  [12,]        55                        0.13208
##  [13,]        60                            NaN
##  [14,]        65                            NaN
##  [15,]        70                            NaN
##  [16,]        75                            NaN
##  [17,]        80                            NaN
##  [18,]        85                            NaN
##  [19,]        90                            NaN
##  [20,]        95                            NaN
##  [21,]       100                        0.32075
##  [22,]       105                        0.67925
##  [23,]       110                        0.15094
##  [24,]       115                        0.33962
##  [25,]       120                        0.00000
##  [26,]       125                        1.11321
##  [27,]       130                        1.83019
##  [28,]       135                        0.16981
##  [29,]       140                        0.16981
##  [30,]       145                        0.37736
##  [31,]       150                        0.26415
##  [32,]       155                        0.00000
##  [33,]       160                            NaN
##  [34,]       165                            NaN
##  [35,]       170                            NaN
##  [36,]       175                            NaN
##  [37,]       180                            NaN
##  [38,]       185                            NaN
##  [39,]       190                            NaN
##  [40,]       195                            NaN
##  [41,]       200                        0.00000
##  [42,]       205                        0.00000
##  [43,]       210                        1.13208
##  [44,]       215                        0.00000
##  [45,]       220                        0.00000
##  [46,]       225                        0.13208
##  [47,]       230                        0.00000
##  [48,]       235                        0.22642
##  [49,]       240                        0.00000
##  [50,]       245                        0.00000
##  [51,]       250                        1.54717
##  [52,]       255                        0.94340
##  [53,]       260                            NaN
##  [54,]       265                            NaN
##  [55,]       270                            NaN
##  [56,]       275                            NaN
##  [57,]       280                            NaN
##  [58,]       285                            NaN
##  [59,]       290                            NaN
##  [60,]       295                            NaN
##  [61,]       300                        0.00000
##  [62,]       305                        0.00000
##  [63,]       310                        0.00000
##  [64,]       315                        0.00000
##  [65,]       320                        0.20755
##  [66,]       325                        0.62264
##  [67,]       330                        1.62264
##  [68,]       335                        0.58491
##  [69,]       340                        0.49057
##  [70,]       345                        0.07547
##  [71,]       350                        0.00000
##  [72,]       355                        0.00000
##  [73,]       360                            NaN
##  [74,]       365                            NaN
##  [75,]       370                            NaN
##  [76,]       375                            NaN
##  [77,]       380                            NaN
##  [78,]       385                            NaN
##  [79,]       390                            NaN
##  [80,]       395                            NaN
##  [81,]       400                        1.18868
##  [82,]       405                        0.94340
##  [83,]       410                        2.56604
##  [84,]       415                        0.00000
##  [85,]       420                        0.33962
##  [86,]       425                        0.35849
##  [87,]       430                        4.11321
##  [88,]       435                        0.66038
##  [89,]       440                        3.49057
##  [90,]       445                        0.83019
##  [91,]       450                        3.11321
##  [92,]       455                        1.11321
##  [93,]       460                            NaN
##  [94,]       465                            NaN
##  [95,]       470                            NaN
##  [96,]       475                            NaN
##  [97,]       480                            NaN
##  [98,]       485                            NaN
##  [99,]       490                            NaN
## [100,]       495                            NaN
## [101,]       500                        0.00000
## [102,]       505                        1.56604
## [103,]       510                        3.00000
## [104,]       515                        2.24528
## [105,]       520                        3.32075
## [106,]       525                        2.96226
## [107,]       530                        2.09434
## [108,]       535                        6.05660
## [109,]       540                       16.01887
## [110,]       545                       18.33962
## [111,]       550                       39.45283
## [112,]       555                       44.49057
## [113,]       560                            NaN
## [114,]       565                            NaN
## [115,]       570                            NaN
## [116,]       575                            NaN
## [117,]       580                            NaN
## [118,]       585                            NaN
## [119,]       590                            NaN
## [120,]       595                            NaN
## [121,]       600                       31.49057
## [122,]       605                       49.26415
## [123,]       610                       53.77358
## [124,]       615                       63.45283
## [125,]       620                       49.96226
## [126,]       625                       47.07547
## [127,]       630                       52.15094
## [128,]       635                       39.33962
## [129,]       640                       44.01887
## [130,]       645                       44.16981
## [131,]       650                       37.35849
## [132,]       655                       49.03774
## [133,]       660                            NaN
## [134,]       665                            NaN
## [135,]       670                            NaN
## [136,]       675                            NaN
## [137,]       680                            NaN
## [138,]       685                            NaN
## [139,]       690                            NaN
## [140,]       695                            NaN
## [141,]       700                       43.81132
## [142,]       705                       44.37736
## [143,]       710                       50.50943
## [144,]       715                       54.50943
## [145,]       720                       49.92453
## [146,]       725                       50.98113
## [147,]       730                       55.67925
## [148,]       735                       44.32075
## [149,]       740                       52.26415
## [150,]       745                       69.54717
## [151,]       750                       57.84906
## [152,]       755                       56.15094
## [153,]       760                            NaN
## [154,]       765                            NaN
## [155,]       770                            NaN
## [156,]       775                            NaN
## [157,]       780                            NaN
## [158,]       785                            NaN
## [159,]       790                            NaN
## [160,]       795                            NaN
## [161,]       800                       73.37736
## [162,]       805                       68.20755
## [163,]       810                      129.43396
## [164,]       815                      157.52830
## [165,]       820                      171.15094
## [166,]       825                      155.39623
## [167,]       830                      177.30189
## [168,]       835                      206.16981
## [169,]       840                      195.92453
## [170,]       845                      179.56604
## [171,]       850                      183.39623
## [172,]       855                      167.01887
## [173,]       860                            NaN
## [174,]       865                            NaN
## [175,]       870                            NaN
## [176,]       875                            NaN
## [177,]       880                            NaN
## [178,]       885                            NaN
## [179,]       890                            NaN
## [180,]       895                            NaN
## [181,]       900                      143.45283
## [182,]       905                      124.03774
## [183,]       910                      109.11321
## [184,]       915                      108.11321
## [185,]       920                      103.71698
## [186,]       925                       95.96226
## [187,]       930                       66.20755
## [188,]       935                       45.22642
## [189,]       940                       24.79245
## [190,]       945                       38.75472
## [191,]       950                       34.98113
## [192,]       955                       21.05660
## [193,]       960                            NaN
## [194,]       965                            NaN
## [195,]       970                            NaN
## [196,]       975                            NaN
## [197,]       980                            NaN
## [198,]       985                            NaN
## [199,]       990                            NaN
## [200,]       995                            NaN
## [201,]      1000                       40.56604
## [202,]      1005                       26.98113
## [203,]      1010                       42.41509
## [204,]      1015                       52.66038
## [205,]      1020                       38.92453
## [206,]      1025                       50.79245
## [207,]      1030                       44.28302
## [208,]      1035                       37.41509
## [209,]      1040                       34.69811
## [210,]      1045                       28.33962
## [211,]      1050                       25.09434
## [212,]      1055                       31.94340
## [213,]      1060                            NaN
## [214,]      1065                            NaN
## [215,]      1070                            NaN
## [216,]      1075                            NaN
## [217,]      1080                            NaN
## [218,]      1085                            NaN
## [219,]      1090                            NaN
## [220,]      1095                            NaN
## [221,]      1100                       31.35849
## [222,]      1105                       29.67925
## [223,]      1110                       21.32075
## [224,]      1115                       25.54717
## [225,]      1120                       28.37736
## [226,]      1125                       26.47170
## [227,]      1130                       33.43396
## [228,]      1135                       49.98113
## [229,]      1140                       42.03774
## [230,]      1145                       44.60377
## [231,]      1150                       46.03774
## [232,]      1155                       59.18868
## [233,]      1160                            NaN
## [234,]      1165                            NaN
## [235,]      1170                            NaN
## [236,]      1175                            NaN
## [237,]      1180                            NaN
## [238,]      1185                            NaN
## [239,]      1190                            NaN
## [240,]      1195                            NaN
## [241,]      1200                       63.86792
## [242,]      1205                       87.69811
## [243,]      1210                       94.84906
## [244,]      1215                       92.77358
## [245,]      1220                       63.39623
## [246,]      1225                       50.16981
## [247,]      1230                       54.47170
## [248,]      1235                       32.41509
## [249,]      1240                       26.52830
## [250,]      1245                       37.73585
## [251,]      1250                       45.05660
## [252,]      1255                       67.28302
## [253,]      1260                            NaN
## [254,]      1265                            NaN
## [255,]      1270                            NaN
## [256,]      1275                            NaN
## [257,]      1280                            NaN
## [258,]      1285                            NaN
## [259,]      1290                            NaN
## [260,]      1295                            NaN
## [261,]      1300                       42.33962
## [262,]      1305                       39.88679
## [263,]      1310                       43.26415
## [264,]      1315                       40.98113
## [265,]      1320                       46.24528
## [266,]      1325                       56.43396
## [267,]      1330                       42.75472
## [268,]      1335                       25.13208
## [269,]      1340                       39.96226
## [270,]      1345                       53.54717
## [271,]      1350                       47.32075
## [272,]      1355                       60.81132
## [273,]      1360                            NaN
## [274,]      1365                            NaN
## [275,]      1370                            NaN
## [276,]      1375                            NaN
## [277,]      1380                            NaN
## [278,]      1385                            NaN
## [279,]      1390                            NaN
## [280,]      1395                            NaN
## [281,]      1400                       55.75472
## [282,]      1405                       51.96226
## [283,]      1410                       43.58491
## [284,]      1415                       48.69811
## [285,]      1420                       35.47170
## [286,]      1425                       37.54717
## [287,]      1430                       41.84906
## [288,]      1435                       27.50943
## [289,]      1440                       17.11321
## [290,]      1445                       26.07547
## [291,]      1450                       43.62264
## [292,]      1455                       43.77358
## [293,]      1460                            NaN
## [294,]      1465                            NaN
## [295,]      1470                            NaN
## [296,]      1475                            NaN
## [297,]      1480                            NaN
## [298,]      1485                            NaN
## [299,]      1490                            NaN
## [300,]      1495                            NaN
## [301,]      1500                       30.01887
## [302,]      1505                       36.07547
## [303,]      1510                       35.49057
## [304,]      1515                       38.84906
## [305,]      1520                       45.96226
## [306,]      1525                       47.75472
## [307,]      1530                       48.13208
## [308,]      1535                       65.32075
## [309,]      1540                       82.90566
## [310,]      1545                       98.66038
## [311,]      1550                      102.11321
## [312,]      1555                       83.96226
## [313,]      1560                            NaN
## [314,]      1565                            NaN
## [315,]      1570                            NaN
## [316,]      1575                            NaN
## [317,]      1580                            NaN
## [318,]      1585                            NaN
## [319,]      1590                            NaN
## [320,]      1595                            NaN
## [321,]      1600                       62.13208
## [322,]      1605                       64.13208
## [323,]      1610                       74.54717
## [324,]      1615                       63.16981
## [325,]      1620                       56.90566
## [326,]      1625                       59.77358
## [327,]      1630                       43.86792
## [328,]      1635                       38.56604
## [329,]      1640                       44.66038
## [330,]      1645                       45.45283
## [331,]      1650                       46.20755
## [332,]      1655                       43.67925
## [333,]      1660                            NaN
## [334,]      1665                            NaN
## [335,]      1670                            NaN
## [336,]      1675                            NaN
## [337,]      1680                            NaN
## [338,]      1685                            NaN
## [339,]      1690                            NaN
## [340,]      1695                            NaN
## [341,]      1700                       46.62264
## [342,]      1705                       56.30189
## [343,]      1710                       50.71698
## [344,]      1715                       61.22642
## [345,]      1720                       72.71698
## [346,]      1725                       78.94340
## [347,]      1730                       68.94340
## [348,]      1735                       59.66038
## [349,]      1740                       75.09434
## [350,]      1745                       56.50943
## [351,]      1750                       34.77358
## [352,]      1755                       37.45283
## [353,]      1760                            NaN
## [354,]      1765                            NaN
## [355,]      1770                            NaN
## [356,]      1775                            NaN
## [357,]      1780                            NaN
## [358,]      1785                            NaN
## [359,]      1790                            NaN
## [360,]      1795                            NaN
## [361,]      1800                       40.67925
## [362,]      1805                       58.01887
## [363,]      1810                       74.69811
## [364,]      1815                       85.32075
## [365,]      1820                       59.26415
## [366,]      1825                       67.77358
## [367,]      1830                       77.69811
## [368,]      1835                       74.24528
## [369,]      1840                       85.33962
## [370,]      1845                       99.45283
## [371,]      1850                       86.58491
## [372,]      1855                       85.60377
## [373,]      1860                            NaN
## [374,]      1865                            NaN
## [375,]      1870                            NaN
## [376,]      1875                            NaN
## [377,]      1880                            NaN
## [378,]      1885                            NaN
## [379,]      1890                            NaN
## [380,]      1895                            NaN
## [381,]      1900                       84.86792
## [382,]      1905                       77.83019
## [383,]      1910                       58.03774
## [384,]      1915                       53.35849
## [385,]      1920                       36.32075
## [386,]      1925                       20.71698
## [387,]      1930                       27.39623
## [388,]      1935                       40.01887
## [389,]      1940                       30.20755
## [390,]      1945                       25.54717
## [391,]      1950                       45.66038
## [392,]      1955                       33.52830
## [393,]      1960                            NaN
## [394,]      1965                            NaN
## [395,]      1970                            NaN
## [396,]      1975                            NaN
## [397,]      1980                            NaN
## [398,]      1985                            NaN
## [399,]      1990                            NaN
## [400,]      1995                            NaN
## [401,]      2000                       19.62264
## [402,]      2005                       19.01887
## [403,]      2010                       19.33962
## [404,]      2015                       33.33962
## [405,]      2020                       26.81132
## [406,]      2025                       21.16981
## [407,]      2030                       27.30189
## [408,]      2035                       21.33962
## [409,]      2040                       19.54717
## [410,]      2045                       21.32075
## [411,]      2050                       32.30189
## [412,]      2055                       20.15094
## [413,]      2060                            NaN
## [414,]      2065                            NaN
## [415,]      2070                            NaN
## [416,]      2075                            NaN
## [417,]      2080                            NaN
## [418,]      2085                            NaN
## [419,]      2090                            NaN
## [420,]      2095                            NaN
## [421,]      2100                       15.94340
## [422,]      2105                       17.22642
## [423,]      2110                       23.45283
## [424,]      2115                       19.24528
## [425,]      2120                       12.45283
## [426,]      2125                        8.01887
## [427,]      2130                       14.66038
## [428,]      2135                       16.30189
## [429,]      2140                        8.67925
## [430,]      2145                        7.79245
## [431,]      2150                        8.13208
## [432,]      2155                        2.62264
## [433,]      2160                            NaN
## [434,]      2165                            NaN
## [435,]      2170                            NaN
## [436,]      2175                            NaN
## [437,]      2180                            NaN
## [438,]      2185                            NaN
## [439,]      2190                            NaN
## [440,]      2195                            NaN
## [441,]      2200                        1.45283
## [442,]      2205                        3.67925
## [443,]      2210                        4.81132
## [444,]      2215                        8.50943
## [445,]      2220                        7.07547
## [446,]      2225                        8.69811
## [447,]      2230                        9.75472
## [448,]      2235                        2.20755
## [449,]      2240                        0.32075
## [450,]      2245                        0.11321
## [451,]      2250                        1.60377
## [452,]      2255                        4.60377
## [453,]      2260                            NaN
## [454,]      2265                            NaN
## [455,]      2270                            NaN
## [456,]      2275                            NaN
## [457,]      2280                            NaN
## [458,]      2285                            NaN
## [459,]      2290                            NaN
## [460,]      2295                            NaN
## [461,]      2300                        3.30189
## [462,]      2305                        2.84906
## [463,]      2310                        0.00000
## [464,]      2315                        0.83019
## [465,]      2320                        0.96226
## [466,]      2325                        1.58491
## [467,]      2330                        2.60377
## [468,]      2335                        4.69811
## [469,]      2340                        3.30189
## [470,]      2345                        0.64151
## [471,]      2350                        0.22642
## [472,]      2355                        1.07547
```

```r

# make time series plot
plot(steps_eachInterval_mean[, 2] ~ steps_eachInterval_mean[, 1], type = "l", 
    xlab = "5minute interval", ylab = "averaged steps in each interval", main = "time seriese plot of \n averaged steps in each interval")
```

![plot of chunk unnamed-chunk-4](figure/unnamed-chunk-4.png) 


#3-2  Which 5minute interval, on average across all the days in the dataset, contains the maximum number of steps?

my answer: According to the calculation below, when the interval is 835, the mean of the steps in each interval is maximized.


```r
# get the value of max of the mean of the steps in each interval
maxSteps <- max(steps_eachInterval_mean[, 2], na.rm = TRUE)
# get the value of intervals which has maxSteps
maxdata <- subset(steps_eachInterval_mean, steps_eachInterval_mean[, 2] == maxSteps)
maxdata
```

```
##      intervals mean of steps in each interval
## [1,]       835                          206.2
```



##4 Imputing missing values
#4-1. Calculate and report the total number of missing values in the dataset (i.e. the total number of rows with NA)

my answer :
According to the calculation below, the number of NAs in this dataset was 2304.

```r
NAnum <- sum(is.na(act))
NAnum
```

```
## [1] 2304
```


#4-2. Devise a strategy for filling in all of the missing values in the dataset. The strategy does not need to be sophisticated. For example, you could use the mean/median for that day, or the mean for that 5minute interval, etc.

my answer:
We fill NAs in this dataset with mean steps in each interval.

#4-3.Create a new dataset that is equal to the original dataset but with the missing data filled in.





